# 图算法：最短路径

## 概述

在图中寻找最短路径是计算机科学中的一个基础问题，具有众多实际应用，从计算机网络中的路由到GPS导航系统。本文档涵盖了三种重要的最短路径算法：

1. **广度优先搜索（BFS）** - 适用于无权图
2. **Dijkstra算法** - 适用于边权非负的加权图
3. **Bellman-Ford算法** - 适用于可能包含负权边的加权图

## 最短路径算法

### 1. 广度优先搜索（BFS）

BFS用于在**无权图**中寻找最短路径。它通过先探索当前深度的所有邻接顶点，再进入下一层深度的顶点来工作。

#### BFS的工作原理：

1. 从源顶点开始，并将其标记为已访问
2. 将源顶点加入队列
3. 当队列不为空时：
   - 从队列中取出一个顶点
   - 对每个未访问的相邻顶点：
     - 标记为已访问
     - 设置其距离为当前顶点距离 + 1
     - 设置其前驱为当前顶点
     - 将其加入队列

#### 时间与空间复杂度：

- **时间复杂度**：O(V + E)，其中 V 是顶点数量，E 是边的数量
- **空间复杂度**：O(V)，用于队列和已访问数组

#### 应用场景：

- 社交网络好友推荐（用户之间的最短连接）
- 网页爬虫
- 迷宫求解中的最短路径查找
- 网络广播

### 2. Dijkstra算法

Dijkstra算法用于在**边权非负的加权图**中寻找最短路径。它通过贪心地选择距离最小的未访问顶点，并松弛其所有出边来工作。

#### Dijkstra的工作原理：

1. 将所有顶点的距离初始化为无穷大，源顶点的距离设为0
2. 创建一个优先队列，并将源顶点及其距离0插入其中
3. 当优先队列不为空时：
   - 提取距离最小的顶点
   - 对每个邻接顶点：
     - 如果通过当前顶点可以缩短到达该顶点的距离，则更新距离和前驱

#### 时间与空间复杂度：

- **时间复杂度**：使用二叉堆实现的优先队列时为 O((V + E) log V)
- **空间复杂度**：O(V)，用于距离数组、前驱数组和优先队列

#### 关键概念：
- **贪心策略**：始终选择距离最近的未访问顶点
- **松弛操作**：发现更短路径时更新距离
- **优先队列**：高效获取距离最小的顶点
- **非负权重**：算法无法处理负权边

#### 应用场景：

- GPS导航系统
- 网络路由协议（如 OSPF）
- 航班调度
- 电信网络

### 3. Bellman-Ford算法

Bellman-Ford算法用于在**可能包含负权边的加权图**中寻找最短路径。它还能检测负权环。

#### Bellman-Ford的工作原理：

1. 将所有顶点的距离初始化为无穷大，源顶点的距离设为0
2. 对所有边进行 V-1 次松弛（V 为顶点数量）：
   - 对每条边 (u, v)，权重为 w：
     - 如果 distance[u] + w < distance[v]，则更新 distance[v] = distance[u] + w，并设置 predecessor[v] = u
3. 检测负权环：
   - 对每条边 (u, v)，权重为 w：
     - 如果 distance[u] + w < distance[v]，则存在负权环

#### 时间与空间复杂度：

- **时间复杂度**：O(V × E)，其中 V 是顶点数，E 是边数
- **空间复杂度**：O(V)，用于距离数组和前驱数组

#### 关键概念：
- **边松弛**：核心操作，用于更新最短距离
- **V-1 次迭代**：任何最短路径中最多包含 V-1 条边
- **负环检测**：额外一次迭代用于检测负权环
- **动态规划**：自底向上的最短路径求解方法

#### 应用场景：

- 货币套利检测
- 包含负权边的网络路由
- 含有负边权图的最短路径查找
- 分布式系统算法

## 通用概念

### 图的表示方式

图可以用多种方式表示：

1. **邻接矩阵**：二维数组，`matrix[i][j]` 表示从顶点 i 到 j 的边的权重
2. **邻接表**：数组的列表，每个列表包含某个顶点的邻居
3. **边列表**：图中所有边的列表

### 路径重构

要重构实际的最短路径：
1. 使用前驱数组记录最短路径中每个顶点的前一个顶点
2. 从目标顶点开始，沿着前驱回溯到源顶点
3. 将路径反转以得到正确的顺序

### 各算法适用场景

- **BFS**：适用于无权图或所有边权重相同的图
- **Dijkstra**：适用于边权非负的加权图
- **Bellman-Ford**：适用于可能包含负权边的图，或需要检测负权环的情况

## 扩展阅读

- [算法导论（CLRS）](https://mitpress.mit.edu/books/introduction-algorithms-third-edition)
- [图算法可视化](https://visualgo.net/en/sssp)
- [Dijkstra算法详解](https://www.geeksforgeeks.org/dijkstras-shortest-path-algorithm-greedy-algo-7/)
- [Bellman-Ford算法](https://www.geeksforgeeks.org/bellman-ford-algorithm-dp-23/)